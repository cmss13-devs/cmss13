<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../../"><link rel="stylesheet" href="dmdoc.css"><title>/atom/movable/screen/minimap - byond</title></head><body><header><a href="index.html">byond</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="atom/movable/screen/minimap.html#var">Var Details</a> - <a href="atom/movable/screen/minimap.html#proc">Proc Details</a></header><main><h1>Minimap <aside>/<a href="atom.html">atom</a>/<a href="atom/movable.html">movable</a>/<a href="atom/movable/screen.html">screen</a>/<a href="atom/movable/screen/minimap.html">minimap</a></aside> <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L455"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 455"></a></h1><p>Default HUD screen minimap object</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="atom/movable/screen/minimap.html#var/choices_by_mob">choices_by_mob</a></th><td>assoc list of mob choices by clicking on coords. only exists fleetingly for the wait loop in [/proc/get_coords_from_click]</td></tr><tr><th><a href="atom/movable/screen/minimap.html#var/cur_x_shift">cur_x_shift</a></th><td>The current x pixel shift</td></tr><tr><th><a href="atom/movable/screen/minimap.html#var/cur_y_shift">cur_y_shift</a></th><td>The current y pixel shift</td></tr><tr><th><a href="atom/movable/screen/minimap.html#var/drawing">drawing</a></th><td>Is drawing enbabled</td></tr><tr><th><a href="atom/movable/screen/minimap.html#var/labelled_turfs">labelled_turfs</a></th><td>List of turfs that have labels attached to them. kept around so it can be cleared</td></tr><tr><th><a href="atom/movable/screen/minimap.html#var/live">live</a></th><td>Is the minimap live</td></tr><tr><th><a href="atom/movable/screen/minimap.html#var/max_scroll_ratio">max_scroll_ratio</a></th><td>Max ratio to x_max/y_max you can scroll the map to</td></tr><tr><th><a href="atom/movable/screen/minimap.html#var/minimap_flags">minimap_flags</a></th><td>Minimap flags</td></tr><tr><th><a href="atom/movable/screen/minimap.html#var/shift_size">shift_size</a></th><td>How many pixels to shift each update</td></tr><tr><th><a href="atom/movable/screen/minimap.html#var/south_y_shift">south_y_shift</a></th><td>Whether the vertical shift is currently pushing the map southward</td></tr><tr><th><a href="atom/movable/screen/minimap.html#var/stop_polling">stop_polling</a></th><td>assoc list to determine if get_coords_from_click should stop waiting for an input for that specific mob</td></tr><tr><th><a href="atom/movable/screen/minimap.html#var/target">target</a></th><td>Minimap target</td></tr><tr><th><a href="atom/movable/screen/minimap.html#var/west_x_shift">west_x_shift</a></th><td>Whether the horizontal shift is currently pushing the map westward</td></tr><tr><th><a href="atom/movable/screen/minimap.html#var/x_max">x_max</a></th><td>The horizontal max for this map (set at Initialize)</td></tr><tr><th><a href="atom/movable/screen/minimap.html#var/y_max">y_max</a></th><td>The vertical max for this map (set at Initialize)</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="atom/movable/screen/minimap.html#proc/get_coords_from_click">get_coords_from_click</a></th><td>lets the user get coordinates by clicking the actual map
Returns a list(x_coord, y_coord)
note: sleeps until the user makes a choice, stop_polling is set to TRUE for this specific user or they disconnect</td></tr><tr><th><a href="atom/movable/screen/minimap.html#proc/on_click">on_click</a></th><td>Handles fetching the targetted coordinates when the mob tries to click on this map
does the following:
turns map targetted pixel into a list(x, y)
gets z level of this map
x and y minimap centering is reverted, then the x2 scaling of the map is removed
round up to correct if an odd pixel was clicked and make sure its valid</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/choices_by_mob"><aside class="declaration">var </aside>choices_by_mob <aside>– /list/<a href="mob.html">mob</a></aside> <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L465"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 465"></a></h3><p>assoc list of mob choices by clicking on coords. only exists fleetingly for the wait loop in [/proc/get_coords_from_click]</p><h3 id="var/cur_x_shift"><aside class="declaration">var </aside>cur_x_shift <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L475"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 475"></a></h3><p>The current x pixel shift</p><h3 id="var/cur_y_shift"><aside class="declaration">var </aside>cur_y_shift <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L477"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 477"></a></h3><p>The current y pixel shift</p><h3 id="var/drawing"><aside class="declaration">var </aside>drawing <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L489"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 489"></a></h3><p>Is drawing enbabled</p><h3 id="var/labelled_turfs"><aside class="declaration">var </aside>labelled_turfs <aside>– /list/<a href="turf.html">turf</a></aside> <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L495"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 495"></a></h3><p>List of turfs that have labels attached to them. kept around so it can be cleared</p><h3 id="var/live"><aside class="declaration">var </aside>live <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L483"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 483"></a></h3><p>Is the minimap live</p><h3 id="var/max_scroll_ratio"><aside class="declaration">var </aside>max_scroll_ratio <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L491"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 491"></a></h3><p>Max ratio to x_max/y_max you can scroll the map to</p><h3 id="var/minimap_flags"><aside class="declaration">var </aside>minimap_flags <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L485"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 485"></a></h3><p>Minimap flags</p><h3 id="var/shift_size"><aside class="declaration">var </aside>shift_size <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L469"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 469"></a></h3><p>How many pixels to shift each update</p><h3 id="var/south_y_shift"><aside class="declaration">var </aside>south_y_shift <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L481"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 481"></a></h3><p>Whether the vertical shift is currently pushing the map southward</p><h3 id="var/stop_polling"><aside class="declaration">var </aside>stop_polling <aside>– /list/<a href="mob.html">mob</a></aside> <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L467"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 467"></a></h3><p>assoc list to determine if get_coords_from_click should stop waiting for an input for that specific mob</p><h3 id="var/target"><aside class="declaration">var </aside>target <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L487"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 487"></a></h3><p>Minimap target</p><h3 id="var/west_x_shift"><aside class="declaration">var </aside>west_x_shift <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L479"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 479"></a></h3><p>Whether the horizontal shift is currently pushing the map westward</p><h3 id="var/x_max"><aside class="declaration">var </aside>x_max <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L471"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 471"></a></h3><p>The horizontal max for this map (set at Initialize)</p><h3 id="var/y_max"><aside class="declaration">var </aside>y_max <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L473"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 473"></a></h3><p>The vertical max for this map (set at Initialize)</p><h2 id="proc">Proc Details</h2><h3 id="proc/get_coords_from_click"><aside class="declaration">proc </aside>get_coords_from_click<aside>(/<a href="mob.html">mob</a>/user)  <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L582"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 582"></a></aside></h3><p>lets the user get coordinates by clicking the actual map
Returns a list(x_coord, y_coord)
note: sleeps until the user makes a choice, stop_polling is set to TRUE for this specific user or they disconnect</p><h3 id="proc/on_click"><aside class="declaration">proc </aside>on_click<aside>(/<a href="mob.html">mob</a>/source, /<a href="atom.html">atom</a>/A, params)  <a href="https://github.com/cmss13-devs/cmss13/blob/1ce601c8c1c984080a82f42b65ce9ee6b48f00da/code/controllers/subsystem/minimap.dm#L602"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/minimap.dm 602"></a></aside></h3><p>Handles fetching the targetted coordinates when the mob tries to click on this map
does the following:
turns map targetted pixel into a list(x, y)
gets z level of this map
x and y minimap centering is reverted, then the x2 scaling of the map is removed
round up to correct if an odd pixel was clicked and make sure its valid</p></main><footer>colonialmarines.dme <a href="https://github.com/cmss13-devs/cmss13/tree/1ce601c8c1c984080a82f42b65ce9ee6b48f00da">1ce601c</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>