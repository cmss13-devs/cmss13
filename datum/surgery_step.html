<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/surgery_step - byond</title></head><body><header><a href="index.html">byond</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/surgery_step.html#var">Var Details</a> - <a href="datum/surgery_step.html#proc">Proc Details</a></header><main><h1>/<a href="datum.html">datum</a>/<a href="datum/surgery_step.html">surgery_step</a> <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L1"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 1"></a></h1><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/surgery_step.html#var/accept_any_item">accept_any_item</a></th><td>Does the surgery step accept any item? If true, ignores tools.</td></tr><tr><th><a href="datum/surgery_step.html#var/accept_hand">accept_hand</a></th><td><em>Does the surgery step accept an open hand? If true and the surgeon uses their hand, doesn't check for tools. If wanting to make a
surgery where a hand can do it but tools are faster, give it a long default time and its tools modifiers above 100.</em></td></tr><tr><th><a href="datum/surgery_step.html#var/desc">desc</a></th><td><em>Description of the surgery used for need-different-tool messages,
format: (You could/can't )[&quot;sever the bone in the patient's limb&quot;]( with \the [tool], or )[next step desc]. Can't refer to outside vars as step datums are global.</em></td></tr><tr><th><a href="datum/surgery_step.html#var/failure_sound">failure_sound</a></th><td>failure &gt;:(</td></tr><tr><th><a href="datum/surgery_step.html#var/preop_sound">preop_sound</a></th><td>preop means &quot;in Progress&quot; sound</td></tr><tr><th><a href="datum/surgery_step.html#var/repeat_step">repeat_step</a></th><td>Whether this step continuously repeats as long as a criteria is met. If TRUE, consider setting skip_step_criteria() or using a failure() override to return TRUE to allow it to be canceled or skipped.</td></tr><tr><th><a href="datum/surgery_step.html#var/success_sound">success_sound</a></th><td>Sound of success</td></tr><tr><th><a href="datum/surgery_step.html#var/time">time</a></th><td><em>How long does the step take as a baseline? Modified by the surgeon's skills, the tool used, and, if the parent surgery requires the patient
to be lying down, the surface the patient is buckled to or resting on: surgery table, field surgical bed, rollerbed, table, open ground etc.</em></td></tr><tr><th><a href="datum/surgery_step.html#var/tools">tools</a></th><td><em>Associative list, tools and their step time multiplier. tools_typecache is assigned from from first to last, so if you have a
more specific subtype and its parent in the same list, place the subtype last to override the general parent.
Some are shared defines, some are set on the tool that uses them.</em></td></tr><tr><th><a href="datum/surgery_step.html#var/tools_cache">tools_cache</a></th><td><em>Assoc. list. This is generated on init and is something like an inverse typecache. All types and subtypes of valid tools are in it, associated to the
parent tool type. Example: for an item type /wxy/z, tool_check() returns tools_cache[/wxy/z]. If /wxy is in tools, this will == /wxy; otherwise it == NULL.</em></td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/surgery_step.html#proc/attempt_step">attempt_step</a></th><td>The proc that actually performs the step.</td></tr><tr><th><a href="datum/surgery_step.html#proc/complete">complete</a></th><td>Finishes the surgery and removes it from the target's lists.</td></tr><tr><th><a href="datum/surgery_step.html#proc/extra_checks">extra_checks</a></th><td>does any extra checks that it is SUBTYPED to perform</td></tr><tr><th><a href="datum/surgery_step.html#proc/failure">failure</a></th><td><em>This is used for failed-step narration and relevant failure changes, often damage etc. If it returns TRUE, the step succeeds anyway.
tool_type may be a typepath or simply '1'. Note that a first step done on help-intent doesn't call failure(), it just ends harmlessly.</em></td></tr><tr><th><a href="datum/surgery_step.html#proc/play_failure_sound">play_failure_sound</a></th><td>Plays the failure sound</td></tr><tr><th><a href="datum/surgery_step.html#proc/play_preop_sound">play_preop_sound</a></th><td>Plays Preop Sounds</td></tr><tr><th><a href="datum/surgery_step.html#proc/play_success_sound">play_success_sound</a></th><td>Plays the selected success sound</td></tr><tr><th><a href="datum/surgery_step.html#proc/preop">preop</a></th><td>This is used for beginning-step narration. tool_type may be a typepath or simply '1'.</td></tr><tr><th><a href="datum/surgery_step.html#proc/repeat_step_criteria">repeat_step_criteria</a></th><td>Used by repeating steps to determine whether to keep looping. tool_type may be a typepath or simply '1'.</td></tr><tr><th><a href="datum/surgery_step.html#proc/skip_step_criteria">skip_step_criteria</a></th><td><em>Whether this step is optional and can be skipped if it isn't the last step. There must be a step after it to skip to. As this may be used when
initiating a surgery and deciding whether to skip the first step, it must be able to work without reference to the parent surgery's status,
affected_limb, or location vars. Also, in that case there may be a wait between passing the check and beginning the step while the user picks a surgery.</em></td></tr><tr><th><a href="datum/surgery_step.html#proc/success">success</a></th><td>This is used for end-step narration and relevant success changes - whatever the step is meant to do, if it isn't just flavour. tool_type may be a typepath or simply '1'.</td></tr><tr><th><a href="datum/surgery_step.html#proc/tool_check">tool_check</a></th><td>Checks the given tool, if any, against the step's tools list, and returns one of three options: the tool list key, TRUE, or FALSE to fail the surgery.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/accept_any_item"><aside class="declaration">var </aside>accept_any_item <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L19"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 19"></a></h3><p>Does the surgery step accept any item? If true, ignores tools.</p><h3 id="var/accept_hand"><aside class="declaration">var </aside>accept_hand <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L17"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 17"></a></h3><p><em>Does the surgery step accept an open hand? If true and the surgeon uses their hand, doesn't check for tools. If wanting to make a
surgery where a hand can do it but tools are faster, give it a long default time and its tools modifiers above 100.</em></p><h3 id="var/desc"><aside class="declaration">var </aside>desc <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L5"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 5"></a></h3><p><em>Description of the surgery used for need-different-tool messages,
format: (You could/can't )[&quot;sever the bone in the patient's limb&quot;]( with \the [tool], or )[next step desc]. Can't refer to outside vars as step datums are global.</em></p><h3 id="var/failure_sound"><aside class="declaration">var </aside>failure_sound <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L30"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 30"></a></h3><p>failure &gt;:(</p><h3 id="var/preop_sound"><aside class="declaration">var </aside>preop_sound <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L26"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 26"></a></h3><p>preop means &quot;in Progress&quot; sound</p><h3 id="var/repeat_step"><aside class="declaration">var </aside>repeat_step <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L24"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 24"></a></h3><p>Whether this step continuously repeats as long as a criteria is met. If TRUE, consider setting skip_step_criteria() or using a failure() override to return TRUE to allow it to be canceled or skipped.</p><h3 id="var/success_sound"><aside class="declaration">var </aside>success_sound <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L28"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 28"></a></h3><p>Sound of success</p><h3 id="var/time"><aside class="declaration">var </aside>time <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L22"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 22"></a></h3><p><em>How long does the step take as a baseline? Modified by the surgeon's skills, the tool used, and, if the parent surgery requires the patient
to be lying down, the surface the patient is buckled to or resting on: surgery table, field surgical bed, rollerbed, table, open ground etc.</em></p><h3 id="var/tools"><aside class="declaration">var </aside>tools <aside>– /list</aside> <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L10"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 10"></a></h3><p><em>Associative list, tools and their step time multiplier. tools_typecache is assigned from from first to last, so if you have a
more specific subtype and its parent in the same list, place the subtype last to override the general parent.
Some are shared defines, some are set on the tool that uses them.</em></p><h3 id="var/tools_cache"><aside class="declaration">var </aside>tools_cache <aside>– /list</aside> <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L13"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 13"></a></h3><p><em>Assoc. list. This is generated on init and is something like an inverse typecache. All types and subtypes of valid tools are in it, associated to the
parent tool type. Example: for an item type /wxy/z, tool_check() returns tools_cache[/wxy/z]. If /wxy is in tools, this will == /wxy; otherwise it == NULL.</em></p><h2 id="proc">Proc Details</h2><h3 id="proc/attempt_step"><aside class="declaration">proc </aside>attempt_step<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery, repeating, skipped)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L82"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 82"></a></aside></h3><p>The proc that actually performs the step.</p><h3 id="proc/complete"><aside class="declaration">proc </aside>complete<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/target, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery, cancelled)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L289"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 289"></a></aside></h3><p>Finishes the surgery and removes it from the target's lists.</p><h3 id="proc/extra_checks"><aside class="declaration">proc </aside>extra_checks<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery, repeating, skipped)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L78"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 78"></a></aside></h3><p>does any extra checks that it is SUBTYPED to perform</p><h3 id="proc/failure"><aside class="declaration">proc </aside>failure<aside>(/<a href="mob.html">mob</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, tool_type, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L277"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 277"></a></aside></h3><p><em>This is used for failed-step narration and relevant failure changes, often damage etc. If it returns TRUE, the step succeeds anyway.
tool_type may be a typepath or simply '1'. Note that a first step done on help-intent doesn't call failure(), it just ends harmlessly.</em></p><h3 id="proc/play_failure_sound"><aside class="declaration">proc </aside>play_failure_sound<aside>(/<a href="mob.html">mob</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L283"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 283"></a></aside></h3><p>Plays the failure sound</p><h3 id="proc/play_preop_sound"><aside class="declaration">proc </aside>play_preop_sound<aside>(/<a href="mob.html">mob</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L259"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 259"></a></aside></h3><p>Plays Preop Sounds</p><h3 id="proc/play_success_sound"><aside class="declaration">proc </aside>play_success_sound<aside>(/<a href="mob.html">mob</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L270"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 270"></a></aside></h3><p>Plays the selected success sound</p><h3 id="proc/preop"><aside class="declaration">proc </aside>preop<aside>(/<a href="mob.html">mob</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, tool_type, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L254"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 254"></a></aside></h3><p>This is used for beginning-step narration. tool_type may be a typepath or simply '1'.</p><h3 id="proc/repeat_step_criteria"><aside class="declaration">proc </aside>repeat_step_criteria<aside>(/<a href="mob.html">mob</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, tool_type, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L62"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 62"></a></aside></h3><p>Used by repeating steps to determine whether to keep looping. tool_type may be a typepath or simply '1'.</p><h3 id="proc/skip_step_criteria"><aside class="declaration">proc </aside>skip_step_criteria<aside>(/<a href="mob.html">mob</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L58"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 58"></a></aside></h3><p><em>Whether this step is optional and can be skipped if it isn't the last step. There must be a step after it to skip to. As this may be used when
initiating a surgery and deciding whether to skip the first step, it must be able to work without reference to the parent surgery's status,
affected_limb, or location vars. Also, in that case there may be a wait between passing the check and beginning the step while the user picks a surgery.</em></p><h3 id="proc/success"><aside class="declaration">proc </aside>success<aside>(/<a href="mob.html">mob</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, tool_type, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L265"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 265"></a></aside></h3><p>This is used for end-step narration and relevant success changes - whatever the step is meant to do, if it isn't just flavour. tool_type may be a typepath or simply '1'.</p><h3 id="proc/tool_check"><aside class="declaration">proc </aside>tool_check<aside>(/<a href="mob.html">mob</a>/user, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/surgery)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/modules/surgery/surgery_steps.dm#L66"><img src="git.png" width="16" height="16" title="code/modules/surgery/surgery_steps.dm 66"></a></aside></h3><p>Checks the given tool, if any, against the step's tools list, and returns one of three options: the tool list key, TRUE, or FALSE to fail the surgery.</p></main><footer>colonialmarines.dme <a href="https://github.com/cmss13-devs/cmss13/tree/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9">ce4ac86</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>