<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/tutorial/marine/reqs_line - byond</title></head><body><header><a href="index.html">byond</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/tutorial/marine/reqs_line.html#var">Var Details</a> - <a href="datum/tutorial/marine/reqs_line.html#proc">Proc Details</a></header><main><h1>Marine - Requistions Line <aside>/<a href="datum.html">datum</a>/<a href="datum/tutorial.html">tutorial</a>/<a href="datum/tutorial/marine/reqs_line.html">marine/reqs_line</a></aside> <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L12"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 12"></a></h1><p>Simulates the Requisitions Line experience for newcomers</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#var/active_agent">active_agent</a></th><td>Active agent currently at the line</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#var/agents">agents</a></th><td>List of line 'agents', aka the dummies requesting items, sorted by line order
During normal stages there is one per stage (except for Forgot stage),
During Survival mode there would usually be two: one at the counter, and one moving.
The agents are mapped to a list of item types requested.</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#var/confused_cooldown">confused_cooldown</a></th><td>Cooldown of confusion if an incorrect item is presented</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#var/confused_types">confused_types</a></th><td>Crutch for confusion feedback to work with vending new()ing directly to table - only act surprised once per item type</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#var/hint_timer">hint_timer</a></th><td>Current &quot;hint&quot; timer after which we display visual cues like highlights</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#var/loser_agent">loser_agent</a></th><td>Specifically for <a href="code/datums/tutorial/marine/reqs_line.html#define/TUTORIAL_REQS_LINE_STAGE_MIXED" title="TUTORIAL_REQS_LINE_STAGE_MIXED">TUTORIAL_REQS_LINE_STAGE_MIXED</a>, the agent that forgot an item</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#var/max_survival_agents">max_survival_agents</a></th><td>Max amount of agents per survival wave</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#var/remind_timer">remind_timer</a></th><td>Current &quot;remind&quot; timer after which the agent will remind player of its request</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#var/stage">stage</a></th><td>Current step of the tutorial we're at</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#var/survival_difficulty">survival_difficulty</a></th><td>Difficulty factor per survival wave, increasing both the amount of agents and requested items</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#var/survival_request_random_factor">survival_request_random_factor</a></th><td>Max factor of additional items requested per agent in survival mode. 0.5 = 50% added maximum</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#var/survival_wave">survival_wave</a></th><td>Current survival wave</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#proc/a_new_challenger_appears">a_new_challenger_appears</a></th><td>Called when an agent presents at the line window and needs to make a request</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#proc/agent_step">agent_step</a></th><td>Makes agents move on processing tick if they can. They check surroundings to ensure proper movement flow.</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#proc/clean_agent">clean_agent</a></th><td>Cleanup when an agent reaches the exit</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#proc/clean_items">clean_items</a></th><td>Cleanup the table and ground contents when an agent leaves the line</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#proc/item_offered">item_offered</a></th><td>Triggered when an object is put on the table. The agent evaluates if that's something they want and reacts appropriately.</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#proc/kill_timers">kill_timers</a></th><td>Kills active timers to reset state</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#proc/remind_request">remind_request</a></th><td>Called when we need to remind the user of what we want served</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#proc/restock_one_vendor">restock_one_vendor</a></th><td>Refills a specific vendor to 99 items across the board</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#proc/restock_vendors">restock_vendors</a></th><td>Refills all the vendors on stage updates so the player shouldn't run out of stock</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#proc/scan_table_for_items">scan_table_for_items</a></th><td>Re-scan the table/trade turf for any present items. We have to do this because items vended to the table do not move onto it.</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#proc/send_hints">send_hints</a></th><td>Displays appropriate hints for the user based on tutorial stage</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#proc/spawn_agent">spawn_agent</a></th><td>Creates a new agent with the given request list to queue in the line</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#proc/spawn_survival_agent">spawn_survival_agent</a></th><td>Called to generate a single agent and request</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#proc/spawn_survival_wave">spawn_survival_wave</a></th><td>Called to generate a new survival wave of agents</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#proc/user_in_position">user_in_position</a></th><td>Called when the player is in position to start handling the line</td></tr><tr><th><a href="datum/tutorial/marine/reqs_line.html#proc/verbalize_request">verbalize_request</a></th><td>Transforms the list of required items by the agent into a string request for the user</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/active_agent"><aside class="declaration">var </aside>active_agent <aside>– /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/<a href="mob/living/carbon/human.html">human</a></aside> <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L34"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 34"></a></h3><p>Active agent currently at the line</p><h3 id="var/agents"><aside class="declaration">var </aside>agents <aside>– /list/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/<a href="mob/living/carbon/human.html">human</a></aside> <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L31"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 31"></a></h3><p>List of line 'agents', aka the dummies requesting items, sorted by line order
During normal stages there is one per stage (except for Forgot stage),
During Survival mode there would usually be two: one at the counter, and one moving.
The agents are mapped to a list of item types requested.</p><h3 id="var/confused_cooldown"><aside class="declaration">var </aside>confused_cooldown <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L39"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 39"></a></h3><p>Cooldown of confusion if an incorrect item is presented</p><h3 id="var/confused_types"><aside class="declaration">var </aside>confused_types <aside>– /list</aside> <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L41"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 41"></a></h3><p>Crutch for confusion feedback to work with vending new()ing directly to table - only act surprised once per item type</p><h3 id="var/hint_timer"><aside class="declaration">var </aside>hint_timer <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L25"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 25"></a></h3><p>Current &quot;hint&quot; timer after which we display visual cues like highlights</p><h3 id="var/loser_agent"><aside class="declaration">var </aside>loser_agent <aside>– /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/<a href="mob/living/carbon/human.html">human</a></aside> <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L36"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 36"></a></h3><p>Specifically for <a href="code/datums/tutorial/marine/reqs_line.html#define/TUTORIAL_REQS_LINE_STAGE_MIXED" title="TUTORIAL_REQS_LINE_STAGE_MIXED">TUTORIAL_REQS_LINE_STAGE_MIXED</a>, the agent that forgot an item</p><h3 id="var/max_survival_agents"><aside class="declaration">var </aside>max_survival_agents <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L44"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 44"></a></h3><p>Max amount of agents per survival wave</p><h3 id="var/remind_timer"><aside class="declaration">var </aside>remind_timer <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L23"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 23"></a></h3><p>Current &quot;remind&quot; timer after which the agent will remind player of its request</p><h3 id="var/stage"><aside class="declaration">var </aside>stage <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L21"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 21"></a></h3><p>Current step of the tutorial we're at</p><h3 id="var/survival_difficulty"><aside class="declaration">var </aside>survival_difficulty <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L48"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 48"></a></h3><p>Difficulty factor per survival wave, increasing both the amount of agents and requested items</p><h3 id="var/survival_request_random_factor"><aside class="declaration">var </aside>survival_request_random_factor <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L50"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 50"></a></h3><p>Max factor of additional items requested per agent in survival mode. 0.5 = 50% added maximum</p><h3 id="var/survival_wave"><aside class="declaration">var </aside>survival_wave <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L46"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 46"></a></h3><p>Current survival wave</p><h2 id="proc">Proc Details</h2><h3 id="proc/a_new_challenger_appears"><aside class="declaration">proc </aside>a_new_challenger_appears<aside>(/<a href="turf.html">turf</a>/source, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/<a href="mob/living/carbon/human.html">human</a>/challenger)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L249"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 249"></a></aside></h3><p>Called when an agent presents at the line window and needs to make a request</p><h3 id="proc/agent_step"><aside class="declaration">proc </aside>agent_step<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/<a href="mob/living/carbon/human.html">human</a>/agent, dir)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L202"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 202"></a></aside></h3><p>Makes agents move on processing tick if they can. They check surroundings to ensure proper movement flow.</p><h3 id="proc/clean_agent"><aside class="declaration">proc </aside>clean_agent<aside>(/<a href="datum.html">datum</a>/source)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L367"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 367"></a></aside></h3><p>Cleanup when an agent reaches the exit</p><h3 id="proc/clean_items"><aside class="declaration">proc </aside>clean_items<aside>()  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L374"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 374"></a></aside></h3><p>Cleanup the table and ground contents when an agent leaves the line</p><h3 id="proc/item_offered"><aside class="declaration">proc </aside>item_offered<aside>(/<a href="turf.html">turf</a>/source, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/item)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L297"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 297"></a></aside></h3><p>Triggered when an object is put on the table. The agent evaluates if that's something they want and reacts appropriately.</p><h3 id="proc/kill_timers"><aside class="declaration">proc </aside>kill_timers<aside>()  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L383"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 383"></a></aside></h3><p>Kills active timers to reset state</p><h3 id="proc/remind_request"><aside class="declaration">proc </aside>remind_request<aside>()  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L268"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 268"></a></aside></h3><p>Called when we need to remind the user of what we want served</p><h3 id="proc/restock_one_vendor"><aside class="declaration">proc </aside>restock_one_vendor<aside>(/<a href="obj.html">obj</a>/<a href="obj/structure/machinery.html">structure/machinery</a>/<a href="obj/structure/machinery/cm_vending.html">cm_vending</a>/vendor)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L184"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 184"></a></aside></h3><p>Refills a specific vendor to 99 items across the board</p><h3 id="proc/restock_vendors"><aside class="declaration">proc </aside>restock_vendors<aside>()  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L175"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 175"></a></aside></h3><p>Refills all the vendors on stage updates so the player shouldn't run out of stock</p><h3 id="proc/scan_table_for_items"><aside class="declaration">proc </aside>scan_table_for_items<aside>(/<a href="datum.html">datum</a>/source)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L328"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 328"></a></aside></h3><p>Re-scan the table/trade turf for any present items. We have to do this because items vended to the table do not move onto it.</p><h3 id="proc/send_hints"><aside class="declaration">proc </aside>send_hints<aside>()  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L392"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 392"></a></aside></h3><p>Displays appropriate hints for the user based on tutorial stage</p><h3 id="proc/spawn_agent"><aside class="declaration">proc </aside>spawn_agent<aside>(/list/request, name_prefix)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L215"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 215"></a></aside></h3><p>Creates a new agent with the given request list to queue in the line</p><h3 id="proc/spawn_survival_agent"><aside class="declaration">proc </aside>spawn_survival_agent<aside>(items_to_request)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L235"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 235"></a></aside></h3><p>Called to generate a single agent and request</p><h3 id="proc/spawn_survival_wave"><aside class="declaration">proc </aside>spawn_survival_wave<aside>()  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L225"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 225"></a></aside></h3><p>Called to generate a new survival wave of agents</p><h3 id="proc/user_in_position"><aside class="declaration">proc </aside>user_in_position<aside>(/<a href="turf.html">turf</a>/source, /<a href="atom.html">atom</a>/<a href="atom/movable.html">movable</a>/mover)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L427"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 427"></a></aside></h3><p>Called when the player is in position to start handling the line</p><h3 id="proc/verbalize_request"><aside class="declaration">proc </aside>verbalize_request<aside>(/list/original_request)  <a href="https://github.com/cmss13-devs/cmss13/blob/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9/code/datums/tutorial/marine/reqs_line.dm#L275"><img src="git.png" width="16" height="16" title="code/datums/tutorial/marine/reqs_line.dm 275"></a></aside></h3><p>Transforms the list of required items by the agent into a string request for the user</p></main><footer>colonialmarines.dme <a href="https://github.com/cmss13-devs/cmss13/tree/ce4ac86508e4d56788cbf9a38fa95a3f28a3e2f9">ce4ac86</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>